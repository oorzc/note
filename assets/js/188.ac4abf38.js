(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{812:function(_,v,n){"use strict";n.r(v);var r=n(5),b=Object(r.a)({},(function(){var _=this,v=_.$createElement,n=_._self._c||v;return n("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[n("h2",{attrs:{id:"mysql优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql优化"}},[_._v("#")]),_._v(" mysql优化")]),_._v(" "),n("p",[n("img",{attrs:{src:"http://qiniu.sponges.cn/201902242058_814.png?imageView2/0/w/880/h/680",alt:""}})]),_._v(" "),n("p",[n("img",{attrs:{src:"http://qiniu.sponges.cn/201902242102_568.png?imageView2/0/w/880/h/680",alt:""}})]),_._v(" "),n("p",[n("img",{attrs:{src:"http://qiniu.sponges.cn/201902242102_255.png?imageView2/0/w/880/h/680",alt:""}})]),_._v(" "),n("p",[_._v("请简述项目中优化SQL语句执行效率的方法，从哪些方面，SQL语"),n("br"),_._v("\n句性能如何分析?")]),_._v(" "),n("p",[_._v("考官考点"),n("br"),_._v("\n查找分析查询速度慢的原因"),n("br"),_._v("\n优化查询过程中的数据访问"),n("br"),_._v("\n优化长难的查询语句"),n("br"),_._v("\n优化特定类型的查询语句"),n("br"),_._v("\n分析SQL查询慢的方法"),n("br"),_._v("\n记录慢查询日志"),n("br"),_._v("\n分析查询日志，不要直接打开慢查询日志进行分析，这样比较浪费"),n("br"),_._v("\n时间和精力，可以使用pt-query-digest工具进行分析")]),_._v(" "),n("p",[_._v("查找分析查询速度慢的原因")]),_._v(" "),n("p",[_._v("使用show profile"),n("br"),_._v("\nset profiling=1;开启，服务器上执行的所有语句会检测消耗的时"),n("br"),_._v("\n间，存到临时表中"),n("br"),_._v("\nshow profiles"),n("br"),_._v("\nshow profile for query 临时表ID")]),_._v(" "),n("p",[n("img",{attrs:{src:"http://qiniu.sponges.cn/201902211505_506.png?imageView2/0/w/880/h/680",alt:""}})]),_._v(" "),n("p",[_._v("使用show status"),n("br"),_._v("\nshow status会返回一些计数器，show global status查看服务器"),n("br"),_._v("\n级别的所有计数"),n("br"),_._v("\n有时根据这些计数，可以猜测出哪些操作代价较高或者消耗时间多"),n("br"),_._v("\n使用show processlist"),n("br"),_._v("\n观察是否有大量线程处于不正常的状态或者特征")]),_._v(" "),n("p",[_._v("使用explain"),n("br"),_._v("\n分析单条SQL语句")]),_._v(" "),n("p",[_._v("优化查询过程中的数据访问")]),_._v(" "),n("p",[_._v("避免使用如下SQL语句"),n("br"),_._v("\n查询不需要的记录，使用limit解决"),n("br"),_._v("\n多表关联返回全部列，指定A.id,A.name,B.age"),n("br"),_._v("\n总是取出全部列，SELECT*会让优化器无法完成索引覆盖扫描的"),n("br"),_._v("\n重复查询相同的数据，可以缓存数据，下次直接读取缓存")]),_._v(" "),n("p",[_._v("是否在扫描额外的记录"),n("br"),_._v("\n使用explain来进行分析，如果发现查询需要扫描大量的数据但只"),n("br"),_._v("\n返回少数的行，可以通过如下技巧去优化："),n("br"),_._v("\n使用索引覆盖扫描，把所有用的列都放到索引中，这样存储引擎不"),n("br"),_._v("\n需要回表获取对应行就可以返回结果"),n("br"),_._v("\n改变数据库和表的结构，修改数据表范式"),n("br"),_._v("\n重写SQL语句，让优化器可以以更优的方式执行查询")]),_._v(" "),n("p",[_._v("一个复杂查询还是多个简单查询"),n("br"),_._v("\nMySQL内部每秒能扫描内存中上百万行数据，相比之下，响应数"),n("br"),_._v("\n据给客户端就要慢得多"),n("br"),_._v("\n使用尽可能少的查询是好的，但是有时将一个大的查询分解为多个"),n("br"),_._v("\n小的查询是很有必要的")]),_._v(" "),n("p",[_._v("切分查询"),n("br"),_._v("\n将一个大的查询分为多个小的相同的查询"),n("br"),_._v("\n一次性删除1000万的数据要比一次删除1万，暂停一会的方案更加"),n("br"),_._v("\n损耗服务器开销")]),_._v(" "),n("p",[_._v("分解关联查询"),n("br"),_._v("\n可以将一条关联语句分解成多条SQL来执行"),n("br"),_._v("\n让缓存的效率更高"),n("br"),_._v("\n执行单个查询可以减少锁的竞争"),n("br"),_._v("\n在应用层做关联可以更容易对数据库进行拆分")]),_._v(" "),n("p",[_._v("优化count(）查询"),n("br"),_._v("\ncount("),n("em",[_._v(")中的")]),_._v("会忽略所有的列，直接统计所有列数，因此不要使"),n("br"),_._v("\n用count(列名）"),n("br"),_._v("\nMyISAM中，没有任何WHERE条件的count("),n("em",[_._v("）非常快"),n("br"),_._v("\n当有WHERE条件，MyISAM的count统计不一定比其他表引擎快"),n("br"),_._v("\n可以使用explain查询近似值，用近似值替代count(")]),_._v(")"),n("br"),_._v("\n增加汇总表"),n("br"),_._v("\n使用缓存")]),_._v(" "),n("p",[_._v("优化关联查询"),n("br"),_._v("\n确定ON或者USING子句的列上有索引"),n("br"),_._v("\n确保GROUP EY和ORDERBY中只有一个表中的列，这样MySQL"),n("br"),_._v("\n才有可能使用索引")]),_._v(" "),n("p",[_._v("优化子查询"),n("br"),_._v("\n尽可能使用关联查询来替代")]),_._v(" "),n("p",[_._v("优化GROUP BY和DISTINCT"),n("br"),_._v("\n这两种查询均可使用索引来优化，是最有效的优化方法"),n("br"),_._v("\n关联查询中，使用标识列进行分组的效率会更高"),n("br"),_._v("\n如果不需要ORDERBY，进行GROUP BY时使用ORDER BY"),n("br"),_._v("\nNULL,MySQL不会再进行文件排序")]),_._v(" "),n("p",[_._v("优化LIMIT分页"),n("br"),_._v("\nLIMIT偏移量大的时候，查询效率较低"),n("br"),_._v("\n可以记录上次查询的最大ID，下次查询时直接根据该ID来查询")]),_._v(" "),n("p",[_._v("优化UNION查询"),n("br"),_._v("\nUNION ALL的效率高于UNION")]),_._v(" "),n("p",[_._v("请简述一下数据库的优化?")]),_._v(" "),n("p",[_._v("1.从结构层: web服务器采用负载均衡服务器,mysql服务器采用主从复制,读写分离"),n("br"),_._v("\n2.从储存层: 采用合适的存储引擎,采用三范式"),n("br"),_._v("\n3.从设计层: 采用分区分表,索引,表的字段采用合适的字段属性,适当的采用逆范式,开启mysql缓存"),n("br"),_._v("\n4.sql语句层:结果一样的情况下,采用效率高,速度快节省资源的sql语句执行")])])}),[],!1,null,null,null);v.default=b.exports}}]);